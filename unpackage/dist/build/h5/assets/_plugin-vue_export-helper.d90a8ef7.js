import{G as t,r as e,H as a,J as o,K as n,L as s,M as u,O as r,N as l,P as i,Q as d,R as g,S as c,T as v,s as f,z as p}from"./index-1d8410b2.js";const S=t("user",(()=>{const t=t=>{if(!t){const t=o("userinfo");return t?JSON.parse(t):{}}a("userinfo",JSON.stringify(t))},n=e(t()),s=t=>{if("string"!=typeof t)return o("authToken")||"";a("authToken",t)},u=e(s()),r=t=>{if(!t){const t=o("globalStaticSettings");return t?JSON.parse(t):{}}a("globalStaticSettings",JSON.stringify(t))},l=e(r()),i=e(0);return{userinfo:n,updateUserinfo:e=>{n.value=e,t(e)},authToken:u,updateToken:t=>{u.value=t,s(t)},curGongde:i,curGongdeAdd1:()=>i.value++,curGongdeAdd:()=>{var t,e;i.value+=(null==(t=l.value)?void 0:t.gongdePerCount)||1,"number"==typeof(null==(e=null==n?void 0:n.value)?void 0:e.total_gongde)&&(n.value.total_gongde+=l.value.gongdePerCount||1)},globalStaticSettings:l,updateGlobalStaticSettings:t=>{l.value=t,r(t)},clearTotalGongde:()=>{var t;"number"==typeof(null==(t=null==n?void 0:n.value)?void 0:t.total_gongde)&&(n.value.total_gongde=0)}}}));function h(t,e){return n(t)?e:t}const b=t=>(e,a=u())=>{!g&&s(t,e,a)},m=b(r),T=b(l),k=b(i),G=b(d),O={invoke(t){var e;-1===t.url.indexOf("http")&&(t.url="http://8.137.77.183:8889"+t.url),t.timeout=9999,t.header={...t.header};const a=null==(e=S().userinfo)?void 0:e.token;return a&&(t.header.Authorization=a),t}};c("request",O),c("uploadFile",O);const _=t=>new Promise(((e,a)=>{v({...t,success(t){t.statusCode>=200&&t.statusCode<300?e(t.data):401===t.statusCode?(S().updateUserinfo({}),S().updateToken(""),S().updateGlobalStaticSettings({}),f({title:"登录过期，请重新登录",icon:"error"}),setTimeout((()=>{p({url:"/pages/login/login"})}),666),a(t)):(f({title:t.data.msg||"未知错误",icon:"none"}),a(t))},fail(t){f({title:"网络错误",icon:"none"}),a(t)}})})),y=(t,e)=>{const a=t.__vccOpts||t;for(const[o,n]of e)a[o]=n;return a};export{y as _,m as a,T as b,h as c,G as d,k as o,_ as r,S as u};
