import{o as e,e as t,w as l,h as a,p as u,q as s,f as n,x as i,j as o,I as d,d as c,s as r,r as m,b as h,u as p,F as b,n as f,y as g}from"./index-1d8410b2.js";import{_,a as V,u as x,c as y,r as k}from"./_plugin-vue_export-helper.d90a8ef7.js";import{t as v}from"./login.6bfc7a5d.js";const S=_({name:"UniNumberBox",emits:["change","input","update:modelValue","blur","focus"],props:{value:{type:[Number,String],default:1},modelValue:{type:[Number,String],default:1},min:{type:Number,default:0},max:{type:Number,default:100},step:{type:Number,default:1},background:{type:String,default:"#f5f5f5"},color:{type:String,default:"#333"},disabled:{type:Boolean,default:!1}},data:()=>({inputValue:0}),watch:{value(e){this.inputValue=+e},modelValue(e){this.inputValue=+e}},created(){1===this.value&&(this.inputValue=+this.modelValue),1===this.modelValue&&(this.inputValue=+this.value)},methods:{_calcValue(e){if(this.disabled)return;const t=this._getDecimalScale();let l=this.inputValue*t,a=this.step*t;if("minus"===e){if(l-=a,l<this.min*t)return;l>this.max*t&&(l=this.max*t)}if("plus"===e){if(l+=a,l>this.max*t)return;l<this.min*t&&(l=this.min*t)}this.inputValue=(l/t).toFixed(String(t).length-1),this.$emit("change",+this.inputValue),this.$emit("input",+this.inputValue),this.$emit("update:modelValue",+this.inputValue)},_getDecimalScale(){let e=1;return~~this.step!==this.step&&(e=Math.pow(10,String(this.step).split(".")[1].length)),e},_onBlur(e){this.$emit("blur",e);let t=e.detail.value;if(isNaN(t))return void(this.inputValue=this.min);t=+t,t>this.max?t=this.max:t<this.min&&(t=this.min);const l=this._getDecimalScale();this.inputValue=t.toFixed(String(l).length-1),this.$emit("change",+this.inputValue),this.$emit("input",+this.inputValue),this.$emit("update:modelValue",+this.inputValue)},_onFocus(e){this.$emit("focus",e)}}},[["render",function(c,r,m,h,p,b){const f=i,g=o,_=d;return e(),t(g,{class:"uni-numbox"},{default:l((()=>[a(g,{onClick:r[0]||(r[0]=e=>b._calcValue("minus")),class:"uni-numbox__minus uni-numbox-btns",style:u({background:m.background})},{default:l((()=>[a(f,{class:s(["uni-numbox--text",{"uni-numbox--disabled":p.inputValue<=m.min||m.disabled}]),style:u({color:m.color})},{default:l((()=>[n("-")])),_:1},8,["class","style"])])),_:1},8,["style"]),a(_,{disabled:m.disabled,onFocus:b._onFocus,onBlur:b._onBlur,class:"uni-numbox__value",type:"number",modelValue:p.inputValue,"onUpdate:modelValue":r[1]||(r[1]=e=>p.inputValue=e),style:u({background:m.background,color:m.color})},null,8,["disabled","onFocus","onBlur","modelValue","style"]),a(g,{onClick:r[2]||(r[2]=e=>b._calcValue("plus")),class:"uni-numbox__plus uni-numbox-btns",style:u({background:m.background})},{default:l((()=>[a(f,{class:s(["uni-numbox--text",{"uni-numbox--disabled":p.inputValue>=m.max||m.disabled}]),style:u({color:m.color})},{default:l((()=>[n("+")])),_:1},8,["class","style"])])),_:1},8,["style"])])),_:1})}],["__scopeId","data-v-6215deab"]]),C=_(c({__name:"settings",setup(u){V((()=>{if(!s.authToken)return r({title:"当前未登录",icon:"error"});i.value=s.globalStaticSettings}));const s=x(),i=m(s.globalStaticSettings||{gongdePerCount:1,autoMuYu:!1,autoMuYuFrequency:1});let d=null;const c=()=>{d&&clearTimeout(d),d=setTimeout((()=>{s.updateGlobalStaticSettings(i.value),d=null,(async()=>{if(!s.authToken)return;const e=await k({url:"/sync-data/post/settings",method:"POST",data:s.globalStaticSettings});console.log(e)})()}),1111)};return(u,d)=>{const r=o,m=y(f("uni-number-box"),S),_=g;return e(),h(b,null,[a(r,{class:"info-box-settings"},{default:l((()=>[a(r,{class:"info-box-title"},{default:l((()=>[n(" 单次功德数 ")])),_:1}),p(s).authToken?(e(),t(r,{key:0},{default:l((()=>[a(m,{onChange:c,modelValue:i.value.gongdePerCount,"onUpdate:modelValue":d[0]||(d[0]=e=>i.value.gongdePerCount=e),background:"#ddb05c",disabled:!1,min:1,max:999,color:"#fff"},null,8,["modelValue"])])),_:1})):(e(),t(r,{key:1,style:{"font-size":"4vw",color:"lightslategray"},onClick:p(v)},{default:l((()=>[n(" 未登录（点击去登录） ")])),_:1},8,["onClick"]))])),_:1}),a(r,{class:"info-box"},{default:l((()=>[a(r,{class:"info-box-title"},{default:l((()=>[n(" 自动木鱼 ")])),_:1}),p(s).authToken?(e(),t(r,{key:0},{default:l((()=>[a(r,{class:"info-box-content"},{default:l((()=>[a(r,null,{default:l((()=>[n(" 开启 ")])),_:1}),a(_,{onChange:d[1]||(d[1]=e=>{(e=>{i.value.autoMuYu=e.detail.value})(e),c()}),color:"#ddb05c",disabled:!1,checked:i.value.autoMuYu},null,8,["checked"])])),_:1}),a(r,{class:"info-box-content"},{default:l((()=>[a(r,null,{default:l((()=>[n(" 自动木鱼时间间隔(秒) ")])),_:1}),a(m,{onChange:c,background:"#ddb05c",disabled:!1,min:.1,max:3,step:.1,color:"#fff",modelValue:i.value.autoMuYuFrequency,"onUpdate:modelValue":d[2]||(d[2]=e=>i.value.autoMuYuFrequency=e)},null,8,["min","step","modelValue"])])),_:1})])),_:1})):(e(),t(r,{key:1,style:{"font-size":"4vw",color:"lightslategray"},onClick:p(v)},{default:l((()=>[n(" 未登录（点击去登录） ")])),_:1},8,["onClick"]))])),_:1})],64)}}}),[["__scopeId","data-v-d1a21abe"]]);export{C as default};
